$(function(){var i=$("#header"),n=i.find("#user-center"),o=n.find(".user-portraint").eq(0),e=i.find(".sub-nav").eq(0),t=e.find(".sub-btn"),s=$("#mask-container"),a=s.find("#person-info"),r=a.find(".btn-back"),l=s.find("#modify-person-password"),c=(l.find(".btn-submit"),l.find(".btn-cancel")),d=s.find("#modify-person-info"),f=(d.find(".btn-submit"),d.find(".btn-cancel")),u=!1;n.hover(function(i){u||(u=!0,e.show(100))},function(i){e.hide(100,function(){u=!1})}),o.hover(function(){$(this).addClass("rotate")},function(){$(this).removeClass("rotate")}),t.on("click",function(){var i=$(this).data("dist");if(e.hide(),void 0!==i){var n=$("#"+i),o=$(window).height();if("person-info"===i){var t=n.data("user"),a=n.find(".item-name-content"),r=n.find(".item-email-content"),l=n.find(".item-portraint-content"),c=n.find(".info-item-skill"),d=window.location.protocol+"//"+window.location.host+"/ShowDoc/voucher/queryVoucherById.action?id="+t;$.ajax({url:d,type:"GET",dataType:"json",success:function(i){a.text(i.voucher.username),r.text(i.voucherInfo.email);var n=i.voucherInfo.skill,o="";if(null===n)o='<span class="item-skill-title">编程技能</span><span class="item-skill-other">无</span>',c.html(o);else{var e=n.split("-"),t="",s=$('<ul class="item-skill-list">');$.each(e,function(i,n){t=t+'<li class="item-skill-item"><span class="item-skill-content">'+n+"</span></li>"}),s.html(t),o='<span class="item-skill-title">编程技能</span>',c.html(o),c.append(s)}var d=$("<img />"),f=window.location.protocol+"//"+window.location.host+i.voucherInfo.picture;d.on("load",function(){l.attr("src",f).hover(function(){l.addClass("rotate")},function(){l.removeClass("rotate")})}),d.attr("src",f)}})}else if("modify-person-info"===i){var f=n.data("user"),u=n.find("#update-info-form"),h=n.find("#modify-info-username"),m=n.find("#modify-info-email"),p=n.find(".modify-info-portraint"),v=p.find(".item-img-result"),w=p.find("#modify-picture"),g=p.find(".valid-error"),y=n.find(".modify-info-skill").find("#modify-skill").find("option"),k=n.find(".modify-form-operations").find(".btn-submit"),b=window.location.protocol+"//"+window.location.host+"/ShowDoc/voucher/queryVoucherById.action?id="+f;v.hide().siblings().show(),$.ajax({url:b,type:"GET",dataType:"json",success:function(i){h.val(i.voucher.username),m.val(i.voucherInfo.email);var o=$("<img />"),e=window.location.protocol+"//"+window.location.host+i.voucherInfo.picture;o.on("load",function(){v.attr("src",e).show().siblings().hide()}),o.attr("src",e);var t=i.voucherInfo.skill;if(null!=t){var s=t.split("-");y.each(function(){var i=this;$.each(s,function(n,o){return $(i).val()===o?void $(i).attr("selected","selected"):void 0})})}n.find(".modify-info-skill").find(".SlectBox").SumoSelect({csvDispCount:12,forceCustomRendering:!0,search:!0}),$.validator.addMethod("isImage",function(i,n){return this.optional(n)||/\w*.jpg|\w*.png|\w*.gif/.test(i)},"只能上传图片"),$.validator.addMethod("isToLarge",function(i,n){var o=n.files[0];return this.optional(n)||o.size/1024<3072},"文件大小不能超过3M"),u.validate({rules:{email:{required:!0,email:!0},picture:{isImage:!0,isToLarge:!0}},messages:{email:{required:"邮箱不能为空",email:"邮箱格式不合格"},picture:{isImage:"只能上传图片",isToLarge:"文件大小不能超过3M"}},errorElement:"p",errorContainer:!0,errorClass:"valid-error",validClass:"valid-pass"}),w.on("change",function(){var i=this.files[0];if(void 0===i||!/image\/\w+/.test(i.type))return void g.text("只能上传图片").css("marginTop","15px").show();var n=new FileReader;n.readAsDataURL(i),n.onload=function(i){$(".item-img-result").attr("src",this.result).show(),$(".item-show-title").hide(),g.text("").hide()}}),k.on("click",function(){return u.valid()&&console.log("通过"),!1})}})}else"modify-person-password"===i&&console.log("modify-person-password");s.show(100,function(){n.css("top","-100%").show();var i=n.height();n.animate({top:(o-i)/2},function(){n.siblings().hide()})})}}),r.on("click",function(){s.hide(function(){s.children().hide()})}),f.on("click",function(){s.hide(function(){s.children().hide()})}),c.on("click",function(){s.hide(function(){s.children().hide()})}),s.on("click",function(i){i.target===this&&s.hide().children().hide()})});