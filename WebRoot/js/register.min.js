$(function(){var e=$("#register-username"),r=$("#register-form"),i=r.find(".register-item").add(".register-logo-item").add(".register-item-select"),s=$("#register-picture"),t=!1,a=!0,o=$("#register-password"),n=$("#register-checkpwd"),l=$("#register-email");$(".SlectBox").SumoSelect({csvDispCount:12,forceCustomRendering:!0,search:!0}),i.on("click",function(){i.css("boxShadow","0 0 0 #888,0 0 1px #888,0 0 2px #888,0 0 3px #888,0 0 4px #888,0 0 5px #888"),$(this).css("boxShadow","0 0 0 #23A7DE,0 0 1px #23A7DE,0 0 2px #23A7DE,0 0 3px #23A7DE,0 0 4px #23A7DE,0 0 5px #23A7DE")}),s.on("change",function(){var e=this.files[0];if(void 0===e||!/image\/\w+/.test(e.type))return void alert("文件必须为图片");var r=new FileReader;r.readAsDataURL(e),r.onload=function(e){$(".item-img-result").attr("src",this.result).show(),$(".item-show-title").hide()}}),$("#register-form").validate({rules:{"voucher.username":{required:!0,rangelength:[6,15]},"voucher.password":{required:!0,rangelength:[6,40]},passwordAgain:{required:!0,rangelength:[6,40],equalTo:"#register-password"},"voucherInfo.email":{required:!0,email:!0}},messages:{"voucher.username":{required:"未输入用户名",rangelength:"用户名为6-15位"},"voucher.password":{required:"未输入密码",rangelength:"密码长度为6-40位"},passwordAgain:{required:"未输入确认密码",rangelength:"密码长度为6-40位",equalTo:"两次输入的密码不一致"},"voucherInfo.email":{required:"未输入邮箱",email:"无效的电子邮件地址"}},onfocusout:!1,onkeyup:!1,errorClass:"valid-error",validClass:"valid-pass",errorElement:"i",errorContainer:!0}),function(){$("#register-form").validate().element(e),$("#register-username-error").css("opacity","0")}(),$("#form-submit").bind("click",function(e){return a=!1,$("#register-username-error").css("opacity","1"),$("#register-form").valid()&&t&&$("#register-form").submit(),!1}),e.on("blur",function(){$("#register-username-error").css("opacity","1");var r=$(this).val(),i="/ShowDoc/voucher/queryByName.action?username="+r;$("#register-form").validate().element(this)&&$.ajax({type:"POST",url:i,dataType:"text",success:function(r){var i=r.trim();"success"===i?t=!0:"fail"===i?(t=!1,e.removeClass("valid-pass").addClass("valid-error").siblings("i").text("用户名已经被注册.").css("display","inline")):"illegal"===i&&e.removeClass("valid-pass").addClass("valid-error").siblings("i").text("用户名应该为6~15位.").css("display","inline")}})}),o.on("blur",function(){a||$("#register-form").validate().element(this)}),n.on("blur",function(){a||$("#register-form").validate().element(this)}),l.on("blur",function(){a||$("#register-form").validate().element(this)})});